import random

class Воин:
    def __init__(self, имя):
        self.имя = имя
        self.здоровье = 120
        self.атака = 15
        self.монеты = 10
        self.инвентарь = []
        self.жизни = 3
        self.история = "Воин был рожден в деревне, где постоянные войны привели к множеству страданий."

class Маг:
    def __init__(self, имя):
        self.имя = имя
        self.здоровье = 80
        self.атака = 25
        self.монеты = 10
        self.инвентарь = []
        self.жизни = 3
        self.история = "Маг вырос в библиотеке древней академии магии, окруженный книгами и свитками."

class Разбойник:
    def __init__(self, имя):
        self.имя = имя
        self.здоровье = 100
        self.атака = 20
        self.монеты = 10
        self.инвентарь = []
        self.жизни = 3
        self.история = "Разбойник родился на улицах шумного города, где выживание требовало ловкости и хитрости."

class Враг:
    def __init__(self, уровень):
        self.здоровье = 20 + уровень * 2
        self.атака = 5 + уровень
        self.монеты = random.randint(10, 20) if уровень % 5 != 0 else 30  
        self.добыча = random.choice(["Зелье восстановления", "Свиток магии", "Монеты"])  

class Магазин:
    def __init__(self):
        self.товары = {
            "Меч": {"цена": 20, "атака": 5, "описание": "Улучшенное оружие для ближнего боя."},
            "Посох": {"цена": 15, "атака": 3, "описание": "Идеален для магов."},
            "Лук": {"цена": 18, "атака": 4, "описание": "Хорош для дальнего боя."},
            "Дубина": {"цена": 25, "атака": 6, "описание": "Сильное оружие для ближнего боя."},
            "Щит": {"цена": 30, "защита": 2, "прочность": 10, "описание": "Защита от атак врага."},
            "Зелье восстановления": {"цена": 10, "восстановление": 25, "описание": "Восстанавливает 25 здоровья."},
            "Свиток магии": {"цена": 15, "бонус_атаки": 10, "длительность": 3, "описание": "Увеличивает атаку на 10 на 3 хода."}
        }

    def показать_товары(self):
        print("Магазин оружия:")
        for товар, параметры in self.товары.items():
            атрибуты = ", ".join([f"{параметр}: {значение}" for параметр, значение in параметры.items()])
            print(f"{товар} - {атрибуты}")

имя_игрока = input("Введите имя вашего персонажа: ")
класс_игрока = input("Выберите класс (1 - Воин, 2 - Маг, 3 - Разбойник): ")

if класс_игрока == "1":
    игрок = Воин(имя_игрока)
elif класс_игрока == "2":
    игрок = Маг(имя_игрока)
elif класс_игрока == "3":
    игрок = Разбойник(имя_игрока)
else:
    print("Некорректный класс. Используется Воин по умолчанию.")
    игрок = Воин(имя_игрока)

уровень = 1
магазин = Магазин()

print(игрок.история)

while игрок.жизни > 0:
    print(f"\nУровень {уровень}")
    враг = Враг(уровень)

    print(f"На вас напал {'Босс' if уровень % 5 == 0 else 'Зомби' if уровень % 2 == 0 else 'Скелет'}!")

    while игрок.здоровье > 0 and враг.здоровье > 0:
        урон_наносимый = random.randint(1, игрок.атака)
        враг.здоровье -= урон_наносимый
        print(f"{игрок.имя} атакует врага и наносит {урон_наносимый} урона.")

        if враг.здоровье <= 0:
            print(f"{игрок.имя} победил врага!")
            игрок.монеты += враг.монеты
            print(f"Вы получили {враг.монеты} монет!")

            дроп = враг.добыча
            действие = input(f"Вы получили {дроп}! Хотите добавить его в инвентарь? (да/нет): ")

            if действие.lower() == "да":
                игрок.инвентарь.append(дроп)
                print(f"Вы добавили {дроп} в инвентарь.")
            break

        урон_получаемый = random.randint(1, враг.атака)
        игрок.здоровье -= урон_получаемый
        print(f"Враг атакует {игрок.имя} и наносит {урон_получаемый} урона.")

        if игрок.здоровье <= 0:
            игрок.жизни -= 1
            if игрок.жизни > 0:
                игрок.здоровье = 100
                print(f"{игрок.имя} потерял жизнь! Осталось жизней: {игрок.жизни}")
            else:
                print(f"{игрок.имя} был повержен! Игра окончена.")
            break

    while True:
        print("\nМеню:")
        print("1. Посмотреть инвентарь")
        print("2. Использовать предмет из инвентаря")
        print("3. Посетить магазин")
        print("4. Переход на следующий уровень")
        действие = input("Выберите действие (1-4): ")

        if действие == '1':
            if игрок.инвентарь:
                print(f"Инвентарь {игрок.имя}: {', '.join(игрок.инвентарь)}")
            else:
                print(f"Инвентарь {игрок.имя} пуст.")
            print(f"Монеты: {игрок.монеты}")
        elif действие == '2':
            if игрок.инвентарь:
                предмет_для_использования = input("Какой предмет вы хотите использовать? ")
                if предмет_для_использования in игрок.инвентарь:
                    if предмет_для_использования == "Зелье восстановления":
                        здоровье_восстановленное = 25
                        игрок.здоровье = min(120, игрок.здоровье + здоровье_восстановленное)
                        print(f"{игрок.имя} использовал {предмет_для_использования} и восстановил {здоровье_восстановленное} здоровья.")
                        игрок.инвентарь.remove(предмет_для_использования)
                    elif предмет_для_использования == "Свиток магии":
                        print(f"{игрок.имя} использовал {предмет_для_использования}, атака увеличена на 10 на 3 хода.")
                        игрок.атака += 10
                        игрок.инвентарь.remove(предмет_для_использования)
                    else:
                        print("Этот предмет не может быть использован.")
                else:
                    print("Такого предмета нет в инвентаре.")
            else:
                print("Ваш инвентарь пуст.")
        elif действие == '3':
            магазин.показать_товары()
            товар_для_покупки = input("Какой предмет вы хотите купить? ")
            if товар_для_покупки in магазин.товары:
                цена = магазин.товары[товар_для_покупки]["цена"]
                if игрок.монеты >= цена:
                    игрок.монеты -= цена
                    игрок.инвентарь.append(товар_для_покупки)
                    print(f"Вы купили {товар_для_покупки}.")
                else:
                    print("Недостаточно монет для покупки.")
            else:
                print("Такого предмета нет в магазине.")
        elif действие == '4':
            уровень += 1 
            break
        else:
            print("Некорректный выбор. Пожалуйста, попробуйте снова.")

print("Игра окончена. Спасибо за игру!")
